# Super Aki80 への適用

この頃都にはやるもの、キラキラ, Super, Aki80 ということで、特価290円で放出されているSuper Aki80 でレトロガイどもが脳みそをいかれさせてしまっている。このトレンドに私もじゃないか。

@DragonBallEZ さんから ROM/RAM 搭載基板をおすそ分け頂いた。それを見ながらつらつら考えたのです。

本体の 32kB SRAM のアクセス速度ゆえ、ここにプログラムを置けない、高速の ROM を確保すべしというのはちょっとあれだし、12ns の高速 SRAM で 64kB 埋めて、ブートローダでモニタなりBASICなりを乗せればよいではないかと。

12ns SRAM は以前秋月で扱いのあったあれを確保しています。これを 32pin DIP に変換するリトルデーモン基板も @DragonBallEZ さんから入手済です。

モニタは秋月ROMがありますが、この場でこの中身を抜いてどうのこうのするのはいかんでしょう。かの @vintagechips さんが「古典電脳物語」を著された際に、Aki80 用のモニタを公開しておられます。それを使わせてもらいましょう。BASIC は先達たる電脳伝説さんが開発しておられます。それを乗せて ASCIIART.BAS を実行して 2分を切る、これしかないと。

Z80MBC_Pico では、ブートローダと UART エミュレーションを搭載していましたが、Super Aki80 ではそれ自身が UART を搭載しています。なので、ブートローダだけ乗せればよいのです。

ということで、以下が改造方針です。

0. 256kbit SRAM を無効化する: 基板そのものに手を入れる。この時点で忘七/人外だが気にしない。とりあえず思いついた手は、74AC00 の 13番ピンを浮かせて、GND にジャンパを繋ぐ。これで、256kbit SRAM の /CE が常時 High になり、無効化される。

1. ROMソケットにリトルデーモン基板を咬ませて 12ns 1Mbit SRAM を乗せる: ROMソケットに ROM/RAM 搭載基板を乗せ、12ns SRAM をそこに乗せる。SRAM の /OE, /WE は Pico2 から供給する。

2. CN2 コネクタに Raspberry Pi Pico2 を繋ぐ: ブートローダ機能に必要な端子は、D0-D7, RESET, BUSRQ, WAIT, MREQ, RD, WR で、それを CN2 から取り出す。Pico2 で /OE, /WE を生成し、SRAM に供給する。Z80が12MHzで動いていようが、WAITさえ掛けてしまえばこっちのもの。Z80 に A0-A15 を生成させ、順次データバスにバイナリを出力し /WE をプルプルしてしまえば、SRAM にデータが書き込まれる。データ書き込みが終われば、リセットを掛けて Pico2 はおとなしくしてしまえばよい。

Super Aki80 は拡張基板に A8-A15 が出ていません。Pico2 だろうが PIC18F53Q47 だろうが、SRAM にアドレスを直接供給してRead/Writeできないのです。ということで、アドレスバスの唯一絶対神である Z80 CPU 様をだまくらかして、こちらの意図通りのアドレスを生成させる必要があります。

